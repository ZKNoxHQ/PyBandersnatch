

# This file was *autogenerated* from the file tests/curve_edwards_test_vectors.sage
from sage.all_cmdline import *   # import sage library

_sage_const_52435875175126190479447740508185965837690552500527637822603658699938581184513 = Integer(52435875175126190479447740508185965837690552500527637822603658699938581184513); _sage_const_0x4247698f4e32ad45a293959b4ca17afa4a2d2317e4c6ce5023e1fd63d1b5de98 = Integer(0x4247698f4e32ad45a293959b4ca17afa4a2d2317e4c6ce5023e1fd63d1b5de98); _sage_const_5 = Integer(5); _sage_const_13108968793781547619861935127046491459309155893440570251786403306729687672801 = Integer(13108968793781547619861935127046491459309155893440570251786403306729687672801); _sage_const_4 = Integer(4); _sage_const_2 = Integer(2); _sage_const_1 = Integer(1); _sage_const_3 = Integer(3); _sage_const_9 = Integer(9); _sage_const_8000 = Integer(8000); _sage_const_0 = Integer(0); _sage_const_31511963179209183026886029814959507395230513391536014203721350106469568871776 = Integer(31511963179209183026886029814959507395230513391536014203721350106469568871776); _sage_const_45347120062487836513813256222005391829075297965413648488198604153937949600247 = Integer(45347120062487836513813256222005391829075297965413648488198604153937949600247); _sage_const_20252373884274151187306374916054971403178400027240398097441693977206289492028 = Integer(20252373884274151187306374916054971403178400027240398097441693977206289492028); _sage_const_51776867226593987565156122032412653740536539297269422625045303422905294395870 = Integer(51776867226593987565156122032412653740536539297269422625045303422905294395870); _sage_const_11997154529596648729624281997554038960651754640906483911385998427296165917073 = Integer(11997154529596648729624281997554038960651754640906483911385998427296165917073); _sage_const_45894336995428141233269187797940484884 = Integer(45894336995428141233269187797940484884); _sage_const_8683555061824981937504960049179714114 = Integer(8683555061824981937504960049179714114); _sage_const_8913659658109529928382530854484400854125314752504019737736543920008458395397 = Integer(8913659658109529928382530854484400854125314752504019737736543920008458395397); _sage_const_0x50281ac0f92fc1b29d2a646fe1f5beb21ec0cb08e81f589296d082245cf9382d = Integer(0x50281ac0f92fc1b29d2a646fe1f5beb21ec0cb08e81f589296d082245cf9382d); _sage_const_0x2123b4c7a71956a2d149cacda650bd7d2516918bf263672811f0feb1e8daef4d = Integer(0x2123b4c7a71956a2d149cacda650bd7d2516918bf263672811f0feb1e8daef4d); _sage_const_0x52c9f28b828426a561f00d3a63511a882ea712770d9af4d6ee0f014d172510b4 = Integer(0x52c9f28b828426a561f00d3a63511a882ea712770d9af4d6ee0f014d172510b4); _sage_const_0x231d3dfa72b4af2d818763ac3629f247733f1d83fd9d3d50e3f6732dae64a8b7 = Integer(0x231d3dfa72b4af2d818763ac3629f247733f1d83fd9d3d50e3f6732dae64a8b7); _sage_const_0x50d06958b6e8ce1ab1b2745bd377e5bde07e867f02611eae1c098cd1519b574a = Integer(0x50d06958b6e8ce1ab1b2745bd377e5bde07e867f02611eae1c098cd1519b574a); _sage_const_0x150f478323e54389c182cabeeae1fa155d29c5c24b3e595703e518e7e336084c = Integer(0x150f478323e54389c182cabeeae1fa155d29c5c24b3e595703e518e7e336084c); _sage_const_0x5ede5fd005b839be71b70d491ebfddeff693de40b4c002a7fc1ae7171cc9f7b5 = Integer(0x5ede5fd005b839be71b70d491ebfddeff693de40b4c002a7fc1ae7171cc9f7b5)# Bandersnatch, Montgomery model
Fp = GF(_sage_const_52435875175126190479447740508185965837690552500527637822603658699938581184513 )
A = Fp(_sage_const_0x4247698f4e32ad45a293959b4ca17afa4a2d2317e4c6ce5023e1fd63d1b5de98 )
B = Fp(_sage_const_5 )
r = _sage_const_13108968793781547619861935127046491459309155893440570251786403306729687672801 
h = _sage_const_4 

# Bandersnatch, Weierstrass model
a = B**_sage_const_2  * (_sage_const_1 -A**_sage_const_2 /_sage_const_3 )
b = B**_sage_const_3  * A * (_sage_const_2 *A**_sage_const_2 /_sage_const_9  - _sage_const_1 ) / _sage_const_3 
E = EllipticCurve(Fp, [a, b])
assert (E.j_invariant() == _sage_const_8000 )
assert (E.order() % r == _sage_const_0 )

# Bandersnatch, Edwards model
# 2017-212, equation (6)
a_ed, d_ed = (A+_sage_const_2 )/B, (A-_sage_const_2 )/B


def to_mg(P):
    u = P[_sage_const_0 ]/P[_sage_const_2 ]
    v = P[_sage_const_1 ]/P[_sage_const_2 ]
    x = u/B - A/_sage_const_3 
    y = v/B**_sage_const_2 
    return x, y


def to_ed(P):
    # 2017-212, equations (4) and (5)
    x, y = to_mg(P)
    u = x/y
    v = (x-_sage_const_1 )/(x+_sage_const_1 )
    return u, v


p = E(_sage_const_31511963179209183026886029814959507395230513391536014203721350106469568871776 ,
      _sage_const_45347120062487836513813256222005391829075297965413648488198604153937949600247 )
q = E(_sage_const_20252373884274151187306374916054971403178400027240398097441693977206289492028 ,
      _sage_const_51776867226593987565156122032412653740536539297269422625045303422905294395870 )
k = _sage_const_11997154529596648729624281997554038960651754640906483911385998427296165917073 
k1 = -_sage_const_45894336995428141233269187797940484884 
k2 = _sage_const_8683555061824981937504960049179714114 
λ = _sage_const_8913659658109529928382530854484400854125314752504019737736543920008458395397 

u, v = to_ed(p)
assert a_ed * u**_sage_const_2  + v**_sage_const_2  == _sage_const_1 +d_ed * u**_sage_const_2 *v**_sage_const_2 


def φ(p):
    # see rmX and smX in `φ.sage`
    x_p, y_p = to_ed(p)
    α = _sage_const_0x50281ac0f92fc1b29d2a646fe1f5beb21ec0cb08e81f589296d082245cf9382d 
    y1 = _sage_const_0x2123b4c7a71956a2d149cacda650bd7d2516918bf263672811f0feb1e8daef4d 
    y2 = _sage_const_0x52c9f28b828426a561f00d3a63511a882ea712770d9af4d6ee0f014d172510b4 
    β = _sage_const_0x52c9f28b828426a561f00d3a63511a882ea712770d9af4d6ee0f014d172510b4 
    y3 = _sage_const_0x231d3dfa72b4af2d818763ac3629f247733f1d83fd9d3d50e3f6732dae64a8b7 
    y4 = _sage_const_0x50d06958b6e8ce1ab1b2745bd377e5bde07e867f02611eae1c098cd1519b574a 
    y5 = _sage_const_0x150f478323e54389c182cabeeae1fa155d29c5c24b3e595703e518e7e336084c 
    y6 = _sage_const_0x5ede5fd005b839be71b70d491ebfddeff693de40b4c002a7fc1ae7171cc9f7b5 
    return α * x_p/y_p * (y_p-y1) * (y_p-y2),  β * (y_p-y3) * (y_p-y4) / ((y_p-y5) * (y_p-y6))

# GENERATION OF TEST VECTORS


def test_vector_point(p, name, ws=True):
    if ws:
        [x, y] = to_ed(p)
    else:
        [x, y] = p
    print("test_vectors['{}'] = E(F({}), F({}), F(1))".format(
        name, hex(x), hex(y)))


def test_vector_scalar(k, name):
    print("test_vectors['{}'] = {}".format(name, hex(k)))


print("F = Field({})".format(hex(Fp.characteristic())))
print("a = F({})".format(a_ed))
print("d = F({})".format(d_ed))
print("r = 0x1cfb69d4ca675f520cce760202687600ff8f87007419047174fd06b52876e7e1")
print("h = 4")
print("E = CurveEdwards(a, d, r, h)")
print("test_vectors = {}")
test_vector_point(p, 'p')
test_vector_point(q, 'q')
test_vector_point(_sage_const_2 *p, 'p_double')
test_vector_point(p+q, 'p_plus_q')
test_vector_point(p-q, 'p_minus_q')
test_vector_point(φ(p), 'φ_p', False)
test_vector_point(k*p, 'k_times_p')
test_vector_point(k1*p, 'k1_times_p')
test_vector_point(k2*p, 'k2_times_p')
test_vector_point(k1*p + k2*q, 'k1_times_p_plus_k2_times_q')
test_vector_scalar(k, 'k')
test_vector_scalar(k1, 'k1')
test_vector_scalar(k2, 'k2')
test_vector_scalar(λ, 'λ')

